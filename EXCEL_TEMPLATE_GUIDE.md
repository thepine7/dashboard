# 📊 엑셀 템플릿 기반 차트 자동 생성 가이드

## 🎯 개요

이제 **엑셀 템플릿 파일**을 생성하면 차트가 자동으로 포함된 엑셀 파일을 다운로드할 수 있습니다!

---

## ✅ 배포 완료 - tomcat2

### 변경 사항:
1. ✅ 엑셀 템플릿 로드 기능 추가
2. ✅ 템플릿이 있으면 차트 포함, 없으면 데이터만 제공
3. ✅ 안정적인 차트 생성 방식

---

## 📝 템플릿 생성 방법

### 1단계: 새 엑셀 파일 생성

1. **Excel 실행**
2. **새 워크북** 생성
3. **파일명**: `chart-template.xlsx`

---

### 2단계: 시트 구성

#### **Sheet 1: 일간 데이터**
```
     A          B      C      D      E    ...  CX
1  날짜명     0:00   0:01   0:02   0:03  ...  23:59
2  2025-10-16  24.2   24.1   24.3   24.0  ...  24.1
3  2025-10-15  24.0   24.2   24.1   24.3  ...  24.2
4  2025-10-14  24.5   24.3   24.4   24.2  ...  24.0
...
10 (빈 행)
```

**중요**: 
- **A열**: 날짜명
- **B열~CX열**: 시간 (0:00~23:59, 1440개 열)
- **1행**: 헤더
- **2~10행**: 데이터 (최대 10일치)

---

#### **Sheet 2: 월간 데이터**
```
     A         B     C     D     E    ...  AF
1  날짜명    1일   2일   3일   4일  ...  31일
2  2025-09   24.2  24.1  24.3  24.0  ...  24.1
3  2025-08   24.0  24.2  24.1  24.3  ...  24.2
```

---

### 3단계: 차트 생성 (일간 데이터 시트)

#### A. 데이터 범위 선택
```
선택 범위: A1:CX10
- A1:A10 = 날짜명 (헤더 + 최대 9일)
- B1:CX10 = 시간 및 데이터 (1440개 열)
```

#### B. 차트 삽입
1. **데이터 선택**: `A1:CX10` 드래그 선택
2. **삽입 탭** 클릭
3. **차트** → **꺾은선형** → **표식이 있는 꺾은선형** 선택

#### C. 차트 위치 조정
- **위치**: 데이터 테이블 아래 (예: `A12:O32`)
- **크기**: 약 15열 너비 x 20행 높이

#### D. 차트 제목 설정
1. 차트 클릭
2. 제목 클릭하여 편집
3. **제목**: `일간 온도 추이` (또는 원하는 제목)

#### E. 축 설정
1. **차트 클릭** → **차트 디자인** 탭
2. **차트 요소 추가** → **축**
   - **가로축 제목**: "시간"
   - **세로축 제목**: "온도 (°C)"

3. **가로축 레이블 간격 조정**:
   - 가로축 우클릭 → **축 서식**
   - **축 옵션** → **레이블**
   - **간격**: 60 (1시간마다 표시)

#### F. 범례 설정
- **위치**: 오른쪽
- **항목**: 자동으로 각 날짜별 시리즈 생성됨

#### G. 차트 스타일
- **차트 스타일**: 스타일 2 또는 3 (깔끔한 스타일)
- **색상**: 기본 색상 팔레트
- **라인 두께**: 2pt
- **마커 크기**: 5pt

---

### 4단계: 데이터 범위 확인 (중요!)

차트가 올바른 데이터를 참조하는지 확인:

1. **차트 선택**
2. **우클릭** → **데이터 선택**
3. **범례 항목(시리즈)** 확인:
   ```
   시리즈 1:
   - 이름: =일간 데이터!$A$2
   - X축: =일간 데이터!$B$1:$CX$1
   - Y축: =일간 데이터!$B$2:$CX$2
   
   시리즈 2:
   - 이름: =일간 데이터!$A$3
   - X축: =일간 데이터!$B$1:$CX$1
   - Y축: =일간 데이터!$B$3:$CX$3
   
   ... (최대 9개 시리즈)
   ```

4. **가로(범주) 축 레이블**: `=일간 데이터!$B$1:$CX$1`

---

### 5단계: 템플릿 저장

1. **파일** → **다른 이름으로 저장**
2. **파일명**: `chart-template.xlsx`
3. **파일 형식**: Excel 통합 문서 (*.xlsx)
4. **저장 위치**: `src/main/resources/excel-templates/`

**경로 예시**:
```
D:\Project\SW\CursorAI\tomcat22\src\main\resources\excel-templates\chart-template.xlsx
```

---

## 🚀 사용 방법

### 1. **템플릿 있을 때**:
- ✅ 차트가 자동으로 포함된 엑셀 파일 다운로드
- ✅ 데이터가 채워지면 차트가 자동 업데이트
- ✅ 안정적이고 에러 없음

### 2. **템플릿 없을 때**:
- ✅ 데이터만 포함된 엑셀 파일 다운로드
- ✅ 사용자가 필요 시 수동으로 차트 생성

---

## 📊 템플릿 작성 시 주의사항

### ✅ DO (해야 할 것)

1. **데이터 범위를 충분히 크게**:
   - 일간: `A1:CX10` (1440개 시간 x 최대 9일)
   - 월간: `A1:AF10` (31일 x 최대 9개월)

2. **차트 위치를 데이터와 겹치지 않게**:
   - 데이터 테이블 아래 또는 오른쪽에 배치

3. **시리즈 개수 제한**:
   - 최대 9~10개 시리즈 (너무 많으면 복잡)

4. **X축 레이블 간격 설정**:
   - 60개마다 표시 (1시간 간격)

5. **파일 형식 확인**:
   - 반드시 `.xlsx` (XML 기반)

### ❌ DON'T (하지 말아야 할 것)

1. **차트를 데이터 위에 배치**:
   - 데이터가 가려지면 안 됨

2. **너무 많은 시리즈 추가**:
   - 10개 이상은 가독성 저하

3. **X축 레이블을 모두 표시**:
   - 1440개 모두 표시하면 너무 빽빽함

4. **`.xls` 형식 사용**:
   - 구버전 형식은 지원 안 됨

---

## 🔧 톰캣 재시작

**템플릿 추가/수정 후 반드시 재시작!**

1. ✅ Synology NAS - Container Manager
2. ✅ `tomcat2` 컨테이너 재시작
3. ⏰ **30초 대기**
4. 📊 엑셀 다운로드 테스트

---

## 💡 템플릿 생성 팁

### 빠른 시작:
1. 먼저 **데이터 없이 차트만** 생성
2. 차트가 올바른 범위 참조하는지 확인
3. 템플릿 저장
4. 톰캣 재시작
5. 다운로드 테스트

### 차트 커스터마이징:
- **색상 변경**: 차트 디자인 탭에서 색상 팔레트 선택
- **라인 스타일**: 각 시리즈 우클릭 → 데이터 계열 서식
- **마커 모양**: 원형, 사각형, 삼각형 등 선택 가능

---

## 📝 현재 상태

### ✅ 구현 완료:
- 템플릿 로드 기능
- 템플릿 없을 때 데이터만 생성
- 안정적인 엑셀 파일 생성

### 📋 다음 단계:
1. **템플릿 파일 생성** (위 가이드 참고)
2. **톰캣 재시작**
3. **테스트 다운로드**
4. **차트 확인**

---

## ❓ 문제 해결

### 문제 1: 차트가 업데이트되지 않음
**해결**: 엑셀에서 `데이터` 탭 → `모두 새로 고침` 클릭

### 문제 2: 차트 범위가 잘못됨
**해결**: 차트 우클릭 → `데이터 선택` → 범위 수정

### 문제 3: 템플릿 로드 실패
**해결**: 
- 파일명 확인: `chart-template.xlsx`
- 경로 확인: `src/main/resources/excel-templates/`
- 톰캣 재시작

---

**템플릿 생성 후 테스트해보세요!** 🎉

